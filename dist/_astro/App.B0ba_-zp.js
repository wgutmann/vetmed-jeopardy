import{r as d,R as Ae}from"./index.B52nOzfP.js";var te={exports:{}},G={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Te=d,Re=Symbol.for("react.element"),Oe=Symbol.for("react.fragment"),Pe=Object.prototype.hasOwnProperty,Le=Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ie={key:!0,ref:!0,__self:!0,__source:!0};function se(s,r,u){var i,p={},o=null,x=null;u!==void 0&&(o=""+u),r.key!==void 0&&(o=""+r.key),r.ref!==void 0&&(x=r.ref);for(i in r)Pe.call(r,i)&&!Ie.hasOwnProperty(i)&&(p[i]=r[i]);if(s&&s.defaultProps)for(i in r=s.defaultProps,r)p[i]===void 0&&(p[i]=r[i]);return{$$typeof:Re,type:s,key:o,ref:x,props:p,_owner:Le.current}}G.Fragment=Oe;G.jsx=se;G.jsxs=se;te.exports=G;var e=te.exports,v=(s=>(s.IDLE="IDLE",s.LOADING="LOADING",s.PLAYING="PLAYING",s.GAME_OVER="GAME_OVER",s))(v||{});const ze=25e3,M=async(s=[])=>{const r=new AbortController,u=setTimeout(()=>r.abort(),ze);try{const i=await fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({existingCategories:s}),signal:r.signal}),p=await i.text();if(!i.ok){const x=X(p);throw new Error(x?.error||"Failed to generate game content")}const o=X(p);if(!o)throw new Error("AI service returned an invalid response");return o}finally{clearTimeout(u)}},X=s=>{try{return JSON.parse(s)}catch{return null}},$=({categories:s,onClueClick:r,readOnly:u=!1})=>e.jsx("div",{className:"w-full max-w-7xl mx-auto p-4 md:p-8",children:e.jsx("div",{className:"overflow-x-auto pb-4 scrollbar-hide",children:e.jsxs("div",{className:"min-w-[900px] grid grid-cols-6 gap-2 md:gap-4",children:[s.map(i=>e.jsx("div",{className:"bg-jeopardy-blue aspect-[4/3] flex items-center justify-center p-2 text-center border-2 border-black/30 shadow-lg rounded-sm",children:e.jsx("h2",{className:"text-white font-bold text-sm md:text-lg uppercase tracking-wide drop-shadow-md font-display",children:i.title})},i.id)),[0,1,2,3,4].map(i=>e.jsx(Ae.Fragment,{children:s.map(p=>{const o=p.clues[i];return e.jsx("button",{onClick:()=>!u&&!o.isAnswered&&r(o),disabled:u||o.isAnswered,className:`
                      aspect-[4/3] flex items-center justify-center 
                      border-2 border-black/30 rounded-sm shadow-md transition-all duration-200
                      ${o.isAnswered?"bg-jeopardy-blue/40 cursor-default":u?"bg-jeopardy-blue cursor-default":"bg-jeopardy-blue hover:bg-blue-800 hover:brightness-110 hover:scale-[1.02] cursor-pointer"}
                    `,children:!o.isAnswered&&e.jsx("span",{className:"text-jeopardy-gold font-display font-bold text-2xl md:text-4xl drop-shadow-sm",children:"$"+o.value})},o.id)})},`row-${i}`))]})})}),Ue=({clue:s,players:r,onClose:u,onAwardPoints:i,buzzerState:p,onArmBuzzers:o,onResetBuzzers:x,isPreview:h=!1})=>{const[m,O]=d.useState(s.isDailyDouble?"DAILY_DOUBLE_WAGER":"CLUE"),[k,R]=d.useState(0),[N,P]=d.useState(""),D=s.isDailyDouble?k:s.value,y=r.find(g=>g.id===p.buzzedPlayerId),A=g=>{g.preventDefault();const w=parseInt(N,10);!isNaN(w)&&w>=0&&(R(w),O("CLUE"))},E=(g,w)=>{i(g,w),w<0&&!s.isDailyDouble?x():u()},C=()=>{i(null,0),u()};return m==="DAILY_DOUBLE_WAGER"?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-md",children:e.jsxs("div",{className:"w-full max-w-2xl bg-gradient-to-b from-blue-900 to-jeopardy-dark border-4 border-jeopardy-gold rounded-xl shadow-2xl overflow-hidden flex flex-col items-center p-8 text-center animate-in zoom-in duration-300",children:[e.jsxs("div",{className:"mb-8 transform hover:scale-105 transition-transform duration-500",children:[e.jsx("h1",{className:"text-6xl md:text-8xl font-display font-bold text-jeopardy-gold drop-shadow-[0_4px_0_rgba(0,0,0,1)] tracking-tighter -rotate-2",children:"DAILY"}),e.jsx("h1",{className:"text-6xl md:text-8xl font-display font-bold text-jeopardy-gold drop-shadow-[0_4px_0_rgba(0,0,0,1)] tracking-tighter rotate-2",children:"DOUBLE"})]}),e.jsx("p",{className:"text-white/80 text-lg mb-6",children:"Enter your wager"}),e.jsxs("form",{onSubmit:A,className:"w-full max-w-sm flex flex-col gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-jeopardy-gold text-2xl font-bold",children:"$"}),e.jsx("input",{type:"number",value:N,onChange:g=>P(g.target.value),className:"w-full bg-black/40 border-2 border-jeopardy-gold/50 rounded-lg py-4 pl-10 pr-4 text-3xl text-white font-bold text-center focus:outline-none focus:border-jeopardy-gold transition-colors",placeholder:"0",autoFocus:!0,min:"0"})]}),e.jsx("button",{type:"submit",disabled:!N,className:"w-full py-4 bg-jeopardy-gold hover:bg-yellow-400 text-jeopardy-dark font-bold text-xl rounded-lg uppercase tracking-wider transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Place Wager"})]})]})}):e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-md transition-opacity duration-300",children:e.jsxs("div",{className:`
        w-full max-w-5xl bg-jeopardy-blue border-4 rounded-xl shadow-2xl overflow-hidden flex flex-col h-[90vh]
        ${s.isDailyDouble?"border-jeopardy-gold shadow-yellow-500/20":"border-white/20"}
      `,children:[e.jsxs("div",{className:"bg-blue-900/50 p-4 text-center border-b border-white/10 shrink-0 flex justify-between items-center",children:[e.jsx("span",{className:"w-8"}),e.jsxs("div",{className:"flex flex-col items-center",children:[s.isDailyDouble&&e.jsx("span",{className:"text-jeopardy-gold text-xs font-bold uppercase tracking-widest mb-1",children:"Daily Double"}),e.jsx("span",{className:"text-jeopardy-gold text-4xl font-bold font-display drop-shadow-md",children:"$"+D})]}),e.jsx("button",{onClick:u,className:"text-white/50 hover:text-white transition-colors",title:"Close without scoring",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center p-6 md:p-12 text-center relative overflow-hidden",children:[e.jsxs("div",{className:"z-10 max-w-4xl flex flex-col items-center gap-6",children:[s.imageUrl&&e.jsx("img",{src:s.imageUrl,alt:"Clue Visual",className:"max-h-[35vh] w-auto rounded-lg shadow-2xl border-2 border-white/20 object-contain bg-black/20"}),e.jsx("div",{className:"text-white text-3xl md:text-6xl font-bold uppercase leading-snug drop-shadow-lg tracking-wide font-display",children:s.question})]}),!s.isDailyDouble&&y&&m==="CLUE"&&e.jsxs("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm z-20 flex flex-col items-center justify-center animate-in fade-in duration-200",children:[e.jsx("span",{className:"text-white/80 uppercase tracking-widest mb-2",children:"Buzzed In"}),e.jsx("div",{className:"text-jeopardy-gold text-6xl font-display font-bold animate-bounce",children:y.name}),e.jsxs("div",{className:"mt-8 flex gap-4",children:[e.jsx("button",{onClick:()=>E(y.id,D),className:"bg-green-600 text-white px-8 py-4 rounded-lg font-bold text-xl hover:bg-green-500",children:"Correct (+)"}),e.jsx("button",{onClick:()=>E(y.id,-D),className:"bg-red-600 text-white px-8 py-4 rounded-lg font-bold text-xl hover:bg-red-500",children:"Incorrect (-)"})]}),e.jsx("button",{onClick:x,className:"mt-4 text-white/50 hover:text-white underline",children:"Ignore / Reset"})]}),m==="ANSWER"&&e.jsxs("div",{className:"mt-12 animate-in fade-in slide-in-from-bottom-4 duration-500 z-10",children:[e.jsx("div",{className:"text-jeopardy-gold text-xl uppercase font-bold mb-2",children:"Correct Response"}),e.jsx("div",{className:"text-white text-2xl md:text-4xl font-medium bg-black/30 p-6 rounded-lg border border-white/10 inline-block",children:s.answer})]})]}),e.jsxs("div",{className:"bg-black/20 p-6 border-t border-white/10 shrink-0",children:[!s.isDailyDouble&&m==="CLUE"&&!h&&e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[p.status==="LOCKED"?e.jsx("button",{onClick:o,className:"w-full max-w-md py-4 bg-jeopardy-gold text-jeopardy-dark font-bold text-2xl rounded-lg uppercase tracking-widest shadow-lg hover:bg-yellow-300 active:scale-95 transition-all",children:"Open Buzzers"}):e.jsx("div",{className:"text-white text-xl font-mono animate-pulse",children:"--- BUZZERS OPEN ---"}),e.jsx("div",{className:"h-px w-full bg-white/10 my-2"}),e.jsx("button",{onClick:()=>O("ANSWER"),className:"px-8 py-2 bg-blue-800 text-white font-bold rounded-full text-sm hover:bg-blue-700 uppercase tracking-wider",children:"Reveal Answer (No Correct Buzz)"})]}),h&&m==="CLUE"&&e.jsx("div",{className:"flex flex-col items-center gap-4",children:e.jsx("button",{onClick:()=>O("ANSWER"),className:"px-8 py-2 bg-blue-800 text-white font-bold rounded-full text-sm hover:bg-blue-700 uppercase tracking-wider",children:"Reveal Answer"})}),(m==="ANSWER"||s.isDailyDouble)&&e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("h3",{className:"text-white/70 uppercase tracking-widest text-sm font-semibold",children:"Manual Adjustments"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-4 w-full",children:r.map(g=>e.jsxs("div",{className:"flex flex-col gap-2 bg-blue-900/40 p-2 rounded-lg border border-white/10",children:[e.jsx("span",{className:"text-white font-bold text-center text-xs truncate max-w-[100px]",children:g.name}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>E(g.id,D),className:"flex-1 py-1 px-2 bg-green-600 text-white rounded text-xs",children:"+"}),e.jsx("button",{onClick:()=>E(g.id,-D),className:"flex-1 py-1 px-2 bg-red-600 text-white rounded text-xs",children:"-"})]})]},g.id))}),e.jsx("button",{onClick:C,className:"mt-2 text-white/50 text-sm hover:underline",children:"Finish Clue"})]})]})]})})},_e=()=>e.jsxs("div",{className:"fixed inset-0 bg-jeopardy-dark flex flex-col items-center justify-center z-50 text-white",children:[e.jsxs("div",{className:"relative w-32 h-32 mb-8",children:[e.jsx("div",{className:"absolute inset-0 border-t-4 border-jeopardy-gold rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-4 border-r-4 border-jeopardy-blue rounded-full animate-spin animation-delay-200"}),e.jsx("div",{className:"absolute inset-8 border-b-4 border-white rounded-full animate-spin animation-delay-500"})]}),e.jsx("h2",{className:"text-3xl font-bold font-display tracking-wider mb-4 animate-pulse text-jeopardy-gold",children:"GENERATING BOARD"}),e.jsx("p",{className:"text-blue-200 max-w-md text-center px-4",children:"Consulting the AI Veterinary Board Specialists to prepare your exam..."})]}),Be=({players:s})=>e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-black/90 border-t border-white/10 p-2 md:p-4 backdrop-blur-md z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4 px-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2 md:mb-0",children:[e.jsx("div",{className:"h-10 w-10 bg-jeopardy-blue rounded-full flex items-center justify-center border border-white/20 shrink-0",children:e.jsx("span",{className:"text-xl",children:"ðŸ©º"})}),e.jsx("span",{className:"text-white/70 font-medium hidden md:inline",children:"VetMed Jeopardy"})]}),e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4 md:gap-8 overflow-x-auto",children:s.map(r=>e.jsxs("div",{className:"flex flex-col items-center min-w-[80px]",children:[e.jsx("span",{className:"text-jeopardy-gold font-display font-bold text-2xl md:text-3xl drop-shadow-md",children:"$"+r.score}),e.jsx("span",{className:"text-white/80 text-sm font-medium uppercase tracking-wide truncate max-w-[120px]",children:r.name})]},r.id))})]})}),Me=({name:s,score:r,status:u,onBuzz:i,boardData:p,activeClue:o})=>{let x="WAIT",h=!0,m="bg-red-900/50";return u==="ARMED"?(m="bg-green-600 hover:bg-green-500 active:bg-green-400",x="BUZZ!",h=!1):u==="BUZZED"?(m="bg-jeopardy-gold text-jeopardy-dark",x="LOCKED IN"):(m="bg-red-900/50",x="LOCKED"),e.jsxs("div",{className:"min-h-screen bg-jeopardy-dark flex flex-col",children:[e.jsxs("div",{className:"bg-blue-900 p-4 flex justify-between items-center border-b border-white/10 shrink-0 z-10 shadow-md",children:[e.jsx("span",{className:"text-white font-bold text-lg truncate max-w-[150px]",children:s}),e.jsx("span",{className:"text-jeopardy-gold font-display font-bold text-2xl",children:"$"+r})]}),e.jsx("div",{className:"flex-grow flex flex-col relative overflow-hidden",children:o?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-6 bg-jeopardy-blue z-20 animate-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"mb-8 text-center space-y-4 max-w-lg flex flex-col items-center",children:[e.jsx("span",{className:"text-jeopardy-gold font-display font-bold text-4xl",children:"$"+o.value}),o.imageUrl&&e.jsx("img",{src:o.imageUrl,alt:"Clue Visual",className:"max-h-32 w-auto rounded shadow-md border border-white/20 mb-2"}),e.jsx("p",{className:"text-white font-medium text-xl md:text-2xl leading-relaxed uppercase font-display tracking-wide",children:o.question})]}),e.jsx("button",{onClick:i,disabled:h,className:`
                  w-48 h-48 md:w-64 md:h-64 rounded-full shadow-2xl border-8 border-white/10
                  flex items-center justify-center text-3xl md:text-5xl font-bold tracking-widest
                  transition-all duration-100 active:scale-95
                  ${m} text-white
                `,children:x}),e.jsx("div",{className:"mt-8 text-white/50 text-sm uppercase tracking-widest animate-pulse",children:u==="ARMED"?"Quick! Tap now!":"Waiting for Host..."})]}):e.jsx("div",{className:"flex-grow overflow-y-auto bg-jeopardy-dark",children:p?e.jsx("div",{className:"pointer-events-none opacity-100 origin-top scale-90 md:scale-100",children:e.jsx($,{categories:p.categories,onClueClick:()=>{},readOnly:!0})}):e.jsx("div",{className:"flex h-full items-center justify-center text-white/30",children:"Waiting for game to start..."})})})]})},W=()=>"https://z8w3v8e3ri.us-east-2.awsapprunner.com".replace(/\/$/,""),Ge=s=>s.replace(/^http/,"ws"),Ze=async()=>{const s=await fetch(`${W()}/rooms`,{method:"POST"});if(!s.ok)throw new Error("Failed to create room");return s.json()},He=async(s,r)=>{const u=await fetch(`${W()}/rooms/${s}/join`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r})});if(!u.ok){const i=await u.json().catch(()=>({}));throw new Error(i?.error||"Unable to join room")}return u.json()},ee=s=>{let r=null,u=!1,i=0;const p=`${Ge(W())}/ws?token=${s.token}`,o=()=>{r=new WebSocket(p),r.addEventListener("open",()=>{i=0,s.onOpen?.()}),r.addEventListener("message",h=>{try{const m=JSON.parse(h.data);m.from==="HOST"?s.onHostMessage?.(m.message):m.from==="PLAYER"&&s.onPlayerMessage?.({playerId:m.playerId,message:m.message})}catch(m){console.error("Failed to parse realtime payload",m)}}),r.addEventListener("close",()=>{s.onClose?.(),u||x()}),r.addEventListener("error",()=>{r?.close()})},x=()=>{i+=1;const h=Math.min(1e4,1e3*Math.pow(2,i));setTimeout(()=>{u||o()},h)};return o(),{close:()=>{u=!0,r?.close()},sendToAll:h=>{s.role==="HOST"&&(!r||r.readyState!==WebSocket.OPEN||r.send(JSON.stringify({target:"ALL",message:h})))},sendToPlayer:(h,m)=>{s.role==="HOST"&&(!r||r.readyState!==WebSocket.OPEN||r.send(JSON.stringify({target:"PLAYER",playerId:h,message:m})))},sendToHost:h=>{s.role==="PLAYER"&&(!r||r.readyState!==WebSocket.OPEN||r.send(JSON.stringify({message:h})))}}},We=()=>{const[s,r]=d.useState("LANDING"),[u,i]=d.useState(""),[p,o]=d.useState(v.IDLE),[x,h]=d.useState(null),[m,O]=d.useState(!1),[k,R]=d.useState([]),[N,P]=d.useState(null),[D,y]=d.useState(null),[A,E]=d.useState(!1),[C,g]=d.useState("AI"),[w,re]=d.useState(""),[T,ae]=d.useState(""),[z,le]=d.useState(""),[oe,ne]=d.useState(0),[ie,de]=d.useState(null),[ce,V]=d.useState(null),[Y,U]=d.useState(""),[_,L]=d.useState({status:"LOCKED",buzzedPlayerId:null}),b=d.useRef(null),Z=d.useRef(new Map),I=d.useRef(null),xe=d.useRef(null),ue=d.useRef(null),me=async()=>{r("HOST"),y(null);try{const t=await Ze();xe.current=t.hostToken,i(t.roomCode),pe(t.hostToken)}catch(t){console.error("Failed to initialize host session:",t),y(t?.message||"Could not start host session")}},pe=t=>{b.current?.close(),b.current=ee({token:t,role:"HOST",onPlayerMessage:({playerId:l,message:a})=>be(l,a),onOpen:()=>{y(null),I.current&&clearInterval(I.current),I.current=setInterval(()=>he(),5e3)},onClose:()=>{y("Lost connection to the signaling service. Attempting to reconnect...")}})},he=()=>{const t=Date.now();b.current?.sendToAll({type:"PING",payload:{t}}),R(l=>l.map(a=>{const n=Z.current.get(a.id)||0;return{...a,isConnected:t-n<15e3}}))},B=t=>({categories:t.categories.map(l=>({...l,clues:l.clues.map(a=>({...a,answer:"HIDDEN ON CLIENT"}))}))}),be=(t,l)=>{switch(l.type){case"JOIN":const a={id:t,name:l.payload.name.substring(0,12),score:0,isConnected:!0};R(n=>n.find(f=>f.id===a.id)?n:[...n,a]),Z.current.set(t,Date.now()),b.current?.sendToPlayer(t,{type:"WELCOME",payload:{score:0}}),x&&b.current?.sendToPlayer(t,{type:"BOARD_UPDATE",payload:B(x)}),N&&(b.current?.sendToPlayer(t,{type:"CLUE_SELECTED",payload:{...N,answer:"HIDDEN"}}),b.current?.sendToPlayer(t,{type:"BUZZER_STATUS",payload:_}));break;case"RESYNC":b.current?.sendToPlayer(t,{type:"BOARD_UPDATE",payload:x?B(x):null}),N&&b.current?.sendToPlayer(t,{type:"CLUE_SELECTED",payload:{...N,answer:"HIDDEN"}}),b.current?.sendToPlayer(t,{type:"BUZZER_STATUS",payload:_});break;case"PONG":Z.current.set(t,Date.now()),R(n=>n.map(c=>c.id===t?{...c,isConnected:!0}:c));break;case"BUZZ":L(n=>{if(n.status==="ARMED"){const c=t;return S({type:"BUZZER_STATUS",payload:{status:"BUZZED",buzzedPlayerId:c}}),{status:"BUZZED",buzzedPlayerId:c}}return n});break}},S=t=>{b.current?.sendToAll(t)},fe=(t,l)=>{b.current?.sendToPlayer(t,{type:"UPDATE_PLAYERS",payload:{score:l}})},ge=d.useCallback(async()=>{y(null);try{E(!0);let t=x;if(!t){o(v.LOADING);let l=[];if(C==="CSV"){if(!w.trim())throw new Error("Please paste CSV content.");const a=F(w);if(a.length===0)throw new Error("Invalid CSV.");a.length===6&&a.every(c=>c.clues.length===5)?l=a:l=(await M(a)).categories}else l=(await M([])).categories;t=J(l),h(t)}o(v.PLAYING),S({type:"BOARD_UPDATE",payload:B(t)})}catch(t){console.error(t),y(t.message||"Failed to initialize."),o(v.IDLE)}finally{E(!1)}},[C,w]),we=d.useCallback(async()=>{y(null);try{E(!0);let t=x;if(!t){o(v.LOADING);let l=[];if(C==="CSV"){if(!w.trim())throw new Error("Please paste CSV content.");const a=F(w);if(a.length===0)throw new Error("Invalid CSV.");a.length===6&&a.every(c=>c.clues.length===5)?l=a:l=(await M(a)).categories}else l=(await M()).categories;t=J(l),h(t)}O(!0),o(v.IDLE)}catch(t){console.error(t),y(t.message||"Failed to generate preview."),o(v.IDLE)}finally{E(!1)}},[C,w,x]),ye=async()=>{if(!T||!z){U("Name and Room Code required.");return}U("");try{const t=await He(z.trim().toUpperCase(),T);ue.current={token:t.playerToken,playerId:t.playerId,roomCode:t.roomCode,name:T},b.current?.close(),b.current=ee({token:t.playerToken,role:"PLAYER",onHostMessage:l=>je(l),onOpen:()=>{r("PLAYER"),b.current?.sendToHost({type:"JOIN",payload:{name:T}}),b.current?.sendToHost({type:"RESYNC",payload:{}})},onClose:()=>{U("Connection lost. Reconnecting...")}})}catch(t){console.error("Failed to initialize client session:",t),U(t?.message||"Failed to join game")}},je=t=>{switch(t.type){case"WELCOME":case"UPDATE_PLAYERS":t.payload.score!==void 0&&ne(t.payload.score);break;case"PING":b.current?.sendToHost({type:"PONG",payload:{t:t.payload?.t}});break;case"BOARD_UPDATE":de(t.payload);break;case"CLUE_SELECTED":V(t.payload);break;case"CLUE_CLOSED":V(null);break;case"BUZZER_STATUS":L({status:t.payload.status,buzzedPlayerId:t.payload.buzzedPlayerId});break}},Ne=()=>{b.current?.sendToHost({type:"BUZZ",payload:{}})};d.useEffect(()=>()=>{b.current?.close(),I.current&&clearInterval(I.current)},[]);const J=t=>{let l=t.map((n,c)=>({...n,id:`cat-${c}`,clues:n.clues.map((f,j)=>({...f,id:`clue-${c}-${j}`,isAnswered:!1,isDailyDouble:!1})).sort((f,j)=>f.value-j.value)}));const a=[];if(l.forEach((n,c)=>{n.clues.forEach((f,j)=>{a.push({catIdx:c,clueIdx:j})})}),a.length>0){const n=a[Math.floor(Math.random()*a.length)];l[n.catIdx].clues[n.clueIdx].isDailyDouble=!0}return{categories:l}},F=t=>{const l=t.split(`
`),a={};return l.forEach(n=>{if(!n.trim())return;const c=n.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g),f=c?c.map(j=>j.replace(/^"|"$/g,"").trim()):n.split(",").map(j=>j.trim());if(f.length>=4){const j=f[0],Q=parseInt(f[1],10),De=f[2],Se=f[3],H=f.length>4?f[4]:void 0;a[j]||(a[j]=[]),isNaN(Q)||a[j].push({value:Q,question:De,answer:Se,imageUrl:H&&H.startsWith("http")?H:void 0})}}),Object.keys(a).map(n=>({id:"",title:n,clues:a[n]}))},ve=t=>{P(t),S({type:"CLUE_SELECTED",payload:{...t,answer:"HIDDEN"}});const l={status:"LOCKED",buzzedPlayerId:null};L(l),S({type:"BUZZER_STATUS",payload:l})},Ee=t=>{P(t)},K=()=>{const t={status:"ARMED",buzzedPlayerId:null};L(t),S({type:"BUZZER_STATUS",payload:t})},Ce=()=>{K()},q=()=>{P(null),L({status:"LOCKED",buzzedPlayerId:null}),S({type:"CLUE_CLOSED",payload:{}}),S({type:"BUZZER_STATUS",payload:{status:"LOCKED",buzzedPlayerId:null}})},ke=(t,l)=>{if(x){if(t){let a=0;R(n=>n.map(c=>c.id===t?(a=c.score+l,{...c,score:a}):c)),fe(t,a)}if(l>=0||N?.isDailyDouble){const n={categories:x.categories.map(c=>({...c,clues:c.clues.map(f=>f.id===N?.id?{...f,isAnswered:!0,winnerId:t||void 0}:f)}))};h(n),S({type:"BOARD_UPDATE",payload:B(n)}),q()}}};return s==="PLAYER"?e.jsx(Me,{name:T,score:oe,status:_.status,onBuzz:Ne,boardData:ie,activeClue:ce}):s==="LANDING"?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 to-black flex flex-col items-center justify-center p-6 text-white",children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-display font-bold text-jeopardy-gold mb-12 text-center drop-shadow-lg",children:"VET MED JEOPARDY"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 w-full max-w-4xl",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-md p-8 rounded-2xl border border-white/10 flex flex-col items-center hover:bg-white/15 transition-colors",children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ“º"}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"HOST A GAME"}),e.jsx("p",{className:"text-white/60 text-center mb-8",children:"Create a game board on this screen. Players can join using their phones."}),e.jsx("button",{onClick:me,className:"px-8 py-3 bg-jeopardy-blue hover:bg-blue-600 text-white font-bold rounded-full shadow-lg transition-transform hover:scale-105 w-full",children:"START AS HOST"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-md p-8 rounded-2xl border border-white/10 flex flex-col items-center hover:bg-white/15 transition-colors",children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ“±"}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"JOIN GAME"}),e.jsx("p",{className:"text-white/60 text-center mb-4",children:"Enter the Room Code displayed on the Host screen."}),e.jsxs("div",{className:"w-full space-y-4",children:[e.jsx("input",{type:"text",placeholder:"YOUR NAME",value:T,onChange:t=>ae(t.target.value),className:"w-full bg-black/30 border border-white/30 rounded-lg px-4 py-3 text-center font-bold focus:border-jeopardy-gold outline-none"}),e.jsx("input",{type:"text",placeholder:"ROOM CODE (e.g. ABCD)",value:z,onChange:t=>le(t.target.value),maxLength:4,className:"w-full bg-black/30 border border-white/30 rounded-lg px-4 py-3 text-center font-bold uppercase tracking-widest focus:border-jeopardy-gold outline-none"}),Y&&e.jsx("p",{className:"text-red-400 text-sm text-center",children:Y}),e.jsx("button",{onClick:ye,disabled:!T||z.length<4,className:"px-8 py-3 bg-jeopardy-gold text-blue-900 hover:bg-yellow-400 font-bold rounded-full shadow-lg transition-transform hover:scale-105 w-full disabled:opacity-50 disabled:scale-100",children:"JOIN"})]})]})]})]}):p===v.IDLE?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-950 to-black flex flex-col items-center justify-center p-4 text-center overflow-y-auto",children:e.jsxs("div",{className:"max-w-4xl w-full space-y-8 animate-in fade-in zoom-in duration-700 py-10",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-white/50 text-sm font-bold tracking-widest uppercase",children:"ROOM CODE"}),e.jsx("div",{className:"text-6xl font-mono font-bold text-jeopardy-gold bg-white/10 inline-block px-8 py-4 rounded-xl border-2 border-jeopardy-gold/50 tracking-[0.5em]",children:u}),e.jsx("p",{className:"text-white/30 text-xs",children:"Join at this URL on your phone"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 text-left",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-md p-6 rounded-xl border border-white/10 shadow-xl",children:[e.jsxs("h3",{className:"text-xl text-white font-bold mb-4 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‘¥"})," Players (",k.length,")"]}),e.jsxs("div",{className:"space-y-2 mb-6 max-h-64 overflow-y-auto custom-scrollbar",children:[k.length===0&&e.jsx("p",{className:"text-white/30 italic text-center py-8",children:"Waiting for players to join..."}),k.map(t=>e.jsxs("div",{className:"flex justify-between items-center bg-white/10 px-3 py-3 rounded animate-in fade-in slide-in-from-left-4",children:[e.jsx("span",{className:"text-white font-bold text-lg",children:t.name}),e.jsx("span",{className:"text-green-400 text-xs",children:"CONNECTED"})]},t.id))]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md p-6 rounded-xl border border-white/10 shadow-xl flex flex-col",children:[e.jsxs("h3",{className:"text-xl text-white font-bold mb-4 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{children:"âš™ï¸"})," Game Data"]}),e.jsxs("div",{className:"flex bg-black/40 p-1 rounded-lg mb-4",children:[e.jsx("button",{onClick:()=>g("AI"),className:`flex-1 py-2 rounded-md font-bold text-sm transition-all ${C==="AI"?"bg-jeopardy-blue text-white shadow-md":"text-white/50 hover:text-white"}`,children:"AI Generator"}),e.jsx("button",{onClick:()=>g("CSV"),className:`flex-1 py-2 rounded-md font-bold text-sm transition-all ${C==="CSV"?"bg-jeopardy-blue text-white shadow-md":"text-white/50 hover:text-white"}`,children:"CSV Upload"})]}),C==="AI"?e.jsx("div",{className:"flex-1 flex items-center justify-center text-center p-4 border-2 border-dashed border-white/10 rounded-lg",children:e.jsx("p",{className:"text-white/60 text-sm",children:"The AI will automatically generate 6 categories."})}):e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("textarea",{value:w,onChange:t=>re(t.target.value),placeholder:`Category, Value, Question, Answer, [ImageURL]

Tip: If you provide fewer than 6 categories, AI will fill in the rest!`,className:"flex-1 w-full bg-black/40 border border-white/20 rounded p-3 text-xs font-mono text-white/80 focus:outline-none focus:border-jeopardy-gold resize-none min-h-[150px]"})}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:we,disabled:A,className:`px-4 py-2 rounded-md text-sm text-white/80 ${A?"bg-white/6 cursor-wait":"bg-white/10 hover:bg-white/20"}`,children:A?"Generatingâ€¦":"Preview Board"})})]})]}),D&&e.jsx("div",{className:"p-4 bg-red-500/20 border border-red-500 text-red-200 rounded-lg max-w-2xl mx-auto",children:D}),e.jsxs("button",{onClick:ge,disabled:k.length===0||A,className:"group relative inline-flex items-center justify-center px-16 py-5 overflow-hidden font-bold text-white rounded-full shadow-2xl transition-all duration-300 hover:scale-105 focus:outline-none disabled:opacity-50 disabled:scale-100 cursor-pointer disabled:cursor-not-allowed",children:[e.jsx("span",{className:"absolute inset-0 w-full h-full bg-gradient-to-br from-blue-600 to-blue-800 opacity-100 group-hover:opacity-90"}),e.jsx("span",{className:"relative text-2xl tracking-widest font-display",children:"START GAME"})]})]})}):A?e.jsx(_e,{}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-900 to-slate-900 flex flex-col relative pb-32",children:[e.jsx("header",{className:"bg-blue-950/50 border-b border-white/5 p-4 shadow-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"bg-jeopardy-gold text-jeopardy-dark font-bold px-3 py-1 rounded text-sm",children:["CODE: ",u]}),e.jsx("h1",{className:"text-white font-display font-bold text-xl tracking-wide hidden md:block",children:"VET MED JEOPARDY"})]}),e.jsx("button",{onClick:()=>o(v.IDLE),className:"text-xs text-blue-300 hover:text-white uppercase tracking-widest border border-blue-300/30 px-3 py-1 rounded hover:bg-blue-800 transition-colors",children:"End Game"})]})}),e.jsxs("main",{className:"flex-grow flex items-center",children:[m&&x&&e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"max-w-7xl mx-auto text-white/70 px-4 md:px-8 mb-2",children:"Preview Mode â€” clicking clues will NOT broadcast to players"}),e.jsx($,{categories:x.categories,onClueClick:t=>Ee(t),readOnly:!1})]}),!m&&x&&e.jsx($,{categories:x.categories,onClueClick:ve})]}),e.jsx(Be,{players:k}),N&&e.jsx(Ue,{clue:N,players:k,onClose:q,onAwardPoints:ke,buzzerState:_,onArmBuzzers:K,onResetBuzzers:Ce,isPreview:m})]})};export{We as default};
